# App2 MVC åˆ†å±‚è¯¦è§£

## ğŸ“Š å±‚æ¬¡å…³ç³»å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         HTTP Request                             â”‚
â”‚                    (æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                      ROUTER LAYER (è·¯ç”±å±‚)                       â•‘
â•‘                                                                  â•‘
â•‘  ğŸ“ router.rs                                                    â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â•‘
â•‘  â”‚ â€¢ æ¥æ”¶ HTTP è¯·æ±‚                                        â”‚    â•‘
â•‘  â”‚ â€¢ è§£æ Method å’Œ Path                                   â”‚    â•‘
â•‘  â”‚ â€¢ è·¯ç”±åŒ¹é…å’Œåˆ†å‘                                        â”‚    â•‘
â•‘  â”‚ â€¢ ç®¡ç† Controller å®ä¾‹                                  â”‚    â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                             â”‚
                             â–¼
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                   CONTROLLER LAYER (æ§åˆ¶å™¨å±‚)                    â•‘
â•‘                                                                  â•‘
â•‘  ğŸ® controllers/                                                 â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚ HealthController â”‚  â”‚ MessageControllerâ”‚  â”‚PageControllerâ”‚ â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â•‘
â•‘  â”‚ â€¢ check_health() â”‚  â”‚ â€¢ handle_hello() â”‚  â”‚â€¢ render_home â”‚ â•‘
â•‘  â”‚                  â”‚  â”‚ â€¢ handle_echo()  â”‚  â”‚              â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘           â”‚                     â”‚                    â”‚          â•‘
â•‘           â”‚ è°ƒç”¨ Service        â”‚ è°ƒç”¨ Service       â”‚          â•‘
â•‘           â–¼                     â–¼                    â”‚          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•
            â”‚                     â”‚                    â”‚
            â”‚                     â”‚                    â”‚ è°ƒç”¨ View
            â–¼                     â–¼                    â–¼
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   SERVICE LAYER (æœåŠ¡å±‚)   â•‘  â•‘      VIEW LAYER (è§†å›¾å±‚)          â•‘
â•‘                           â•‘  â•‘                                   â•‘
â•‘  ğŸ”§ services/             â•‘  â•‘  ğŸ¨ views/                        â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘  â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚  HealthService      â”‚ â•‘  â•‘  â”‚  JsonView                   â”‚ â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â•‘  â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â•‘
â•‘  â”‚  â”‚â€¢ get_health()  â”‚ â”‚ â•‘  â•‘  â”‚  â”‚â€¢ render<T>(status, T)  â”‚ â”‚ â•‘
â•‘  â”‚  â”‚â€¢ get_uptime()  â”‚ â”‚ â•‘  â•‘  â”‚  â”‚  - åºåˆ—åŒ–ä¸º JSON       â”‚ â”‚ â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â•‘  â•‘  â”‚  â”‚  - è®¾ç½® Content-Type   â”‚ â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘  â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â•‘
â•‘                           â•‘  â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘  â•‘                                   â•‘
â•‘  â”‚  MessageService     â”‚ â•‘  â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â•‘  â•‘  â”‚  HtmlView                   â”‚ â•‘
â•‘  â”‚  â”‚â€¢ handle_hello()â”‚ â”‚ â•‘  â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â•‘
â•‘  â”‚  â”‚â€¢ handle_echo() â”‚ â”‚ â•‘  â•‘  â”‚  â”‚â€¢ render_home()         â”‚ â”‚ â•‘
â•‘  â”‚  â”‚â€¢ transform()   â”‚ â”‚ â•‘  â•‘  â”‚  â”‚â€¢ render_not_found()    â”‚ â”‚ â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â•‘  â•‘  â”‚  â”‚  - åŠ è½½ HTML æ¨¡æ¿      â”‚ â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘  â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â•‘
â•‘                           â•‘  â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            â”‚                                    â”‚
            â”‚ ä½¿ç”¨ Model                         â”‚
            â–¼                                    â”‚
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    MODEL LAYER (æ¨¡å‹å±‚)                            â•‘
â•‘                                                                    â•‘
â•‘  ğŸ“¦ models/                                                        â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘
â•‘  â”‚  ApiResponse<T>  â”‚  â”‚  HealthCheck     â”‚  â”‚  Message Models â”‚â”‚â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â•‘
â•‘  â”‚â€¢ success         â”‚  â”‚â€¢ status: String  â”‚  â”‚â€¢ EchoRequest    â”‚â”‚â•‘
â•‘  â”‚â€¢ message         â”‚  â”‚â€¢ version: String â”‚  â”‚â€¢ EchoResponse   â”‚â”‚â•‘
â•‘  â”‚â€¢ data: Option<T> â”‚  â”‚â€¢ uptime: u64     â”‚  â”‚â€¢ HelloResponse  â”‚â”‚â•‘
â•‘  â”‚                  â”‚  â”‚                  â”‚  â”‚                 â”‚â”‚â•‘
â•‘  â”‚â€¢ success()       â”‚  â”‚â€¢ new()           â”‚  â”‚â€¢ validate()     â”‚â”‚â•‘
â•‘  â”‚â€¢ error()         â”‚  â”‚â€¢ is_healthy()    â”‚  â”‚â€¢ from_request() â”‚â”‚â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         HTTP Response                            â”‚
â”‚                    (è¿”å›ç»™å®¢æˆ·ç«¯çš„å“åº”)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ æ•°æ®æµå‘

### è¯·æ±‚æµ (Request Flow)

```
Client
  â”‚
  â”‚ HTTP Request
  â–¼
Router â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                      â”‚
  â”‚ è·¯ç”±åŒ¹é…                              â”‚
  â–¼                                      â”‚
Controller â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
  â”‚                â”‚                     â”‚
  â”‚ è°ƒç”¨ Service    â”‚ è°ƒç”¨ View           â”‚
  â–¼                â”‚                     â”‚
Service            â”‚                     â”‚
  â”‚                â”‚                     â”‚
  â”‚ ä½¿ç”¨ Model      â”‚                     â”‚
  â–¼                â”‚                     â”‚
Model              â”‚                     â”‚
  â”‚                â”‚                     â”‚
  â”‚ è¿”å›æ•°æ®        â”‚                     â”‚
  â–¼                â–¼                     â”‚
Controller â”€â”€â”€â”€â”€â”€> View                  â”‚
                    â”‚                    â”‚
                    â”‚ æ¸²æŸ“å“åº”            â”‚
                    â–¼                    â”‚
                  Response â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
                  Client
```

## ğŸ“‹ å„å±‚è¯¦ç»†è¯´æ˜

### 1ï¸âƒ£ Router Layer (è·¯ç”±å±‚)

**æ–‡ä»¶**: `router.rs`

**èŒè´£**:
- ç›‘å¬ TCP è¿æ¥
- è§£æ HTTP è¯·æ±‚
- è·¯ç”±åŒ¹é…
- åˆ†å‘åˆ°å¯¹åº”çš„ Controller

**å…³é”®ä»£ç **:
```rust
match (method, path) {
    (&Method::GET, "/") => self.page_controller.render_home(),
    (&Method::GET, "/health") => self.health_controller.check_health(),
    (&Method::GET, "/api/hello") => self.message_controller.handle_hello(),
    (&Method::POST, "/api/echo") => self.message_controller.handle_echo(req).await,
    _ => self.handle_not_found(),
}
```

**ä¾èµ–**:
- æ‰€æœ‰ Controller
- Tokio (å¼‚æ­¥è¿è¡Œæ—¶)
- Hyper (HTTP åº“)

---

### 2ï¸âƒ£ Controller Layer (æ§åˆ¶å™¨å±‚)

**æ–‡ä»¶**: `controllers/`

**èŒè´£**:
- æ¥æ”¶æ¥è‡ª Router çš„è¯·æ±‚
- è§£æè¯·æ±‚å‚æ•°
- è°ƒç”¨ Service å¤„ç†ä¸šåŠ¡é€»è¾‘
- ä½¿ç”¨ View æ¸²æŸ“å“åº”
- å¤„ç†é”™è¯¯

**ç¤ºä¾‹ - MessageController**:
```rust
pub fn handle_hello(&self) -> Response<Full<Bytes>> {
    // 1. è°ƒç”¨ Service
    let data = self.service.handle_hello();
    
    // 2. æ„å»ºå“åº”
    let response = ApiResponse::success("è¯·æ±‚æˆåŠŸ", data);
    
    // 3. ä½¿ç”¨ View æ¸²æŸ“
    JsonView::render(StatusCode::OK, &response)
}
```

**ä¾èµ–**:
- Service å±‚ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰
- View å±‚ï¼ˆå“åº”æ¸²æŸ“ï¼‰
- Model å±‚ï¼ˆæ•°æ®ç»“æ„ï¼‰

---

### 3ï¸âƒ£ Service Layer (æœåŠ¡å±‚)

**æ–‡ä»¶**: `services/`

**èŒè´£**:
- å®ç°æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
- æ•°æ®å¤„ç†å’Œè½¬æ¢
- æ•°æ®éªŒè¯
- å¯è¢«å¤šä¸ª Controller å¤ç”¨

**ç¤ºä¾‹ - MessageService**:
```rust
pub fn handle_echo(&self, request: EchoRequest) -> Result<EchoResponse, String> {
    // 1. éªŒè¯è¯·æ±‚
    request.validate()?;
    
    // 2. å¤„ç†ä¸šåŠ¡é€»è¾‘
    let response = EchoResponse::from_request(request);
    
    // 3. è¿”å›ç»“æœ
    Ok(response)
}
```

**ä¾èµ–**:
- Model å±‚ï¼ˆæ•°æ®ç»“æ„ï¼‰

**ç‰¹ç‚¹**:
- çº¯ä¸šåŠ¡é€»è¾‘ï¼Œä¸ä¾èµ– HTTP
- æ˜“äºå•å…ƒæµ‹è¯•
- å¯å¤ç”¨

---

### 4ï¸âƒ£ View Layer (è§†å›¾å±‚)

**æ–‡ä»¶**: `views/`

**èŒè´£**:
- æ¸²æŸ“ JSON å“åº”
- æ¸²æŸ“ HTML é¡µé¢
- è®¾ç½® HTTP å¤´
- æ ¼å¼åŒ–è¾“å‡º

**ç¤ºä¾‹ - JsonView**:
```rust
pub fn render<T: Serialize>(status: StatusCode, data: &T) -> Response<Full<Bytes>> {
    // 1. åºåˆ—åŒ–ä¸º JSON
    let json = serde_json::to_string_pretty(data).unwrap();
    
    // 2. æ„å»º HTTP å“åº”
    Response::builder()
        .status(status)
        .header("Content-Type", "application/json")
        .body(Full::new(Bytes::from(json)))
        .unwrap()
}
```

**ä¾èµ–**:
- Serde (åºåˆ—åŒ–)
- Hyper (HTTP å“åº”)

**ç‰¹ç‚¹**:
- ä¸åŒ…å«ä¸šåŠ¡é€»è¾‘
- åªè´Ÿè´£æ ¼å¼åŒ–
- å¯å¤ç”¨

---

### 5ï¸âƒ£ Model Layer (æ¨¡å‹å±‚)

**æ–‡ä»¶**: `models/`

**èŒè´£**:
- å®šä¹‰æ•°æ®ç»“æ„
- å®ç°æ•°æ®éªŒè¯
- åºåˆ—åŒ–/ååºåˆ—åŒ–

**ç¤ºä¾‹ - EchoRequest**:
```rust
#[derive(Deserialize)]
pub struct EchoRequest {
    pub message: String,
}

impl EchoRequest {
    pub fn validate(&self) -> Result<(), String> {
        if self.message.is_empty() {
            return Err("æ¶ˆæ¯ä¸èƒ½ä¸ºç©º".to_string());
        }
        Ok(())
    }
}
```

**ä¾èµ–**:
- Serde (åºåˆ—åŒ–)

**ç‰¹ç‚¹**:
- çº¯æ•°æ®ç»“æ„
- ä¸åŒ…å«ä¸šåŠ¡é€»è¾‘
- å¯åœ¨å„å±‚ä¹‹é—´ä¼ é€’

---

## ğŸ¯ å±‚é—´äº¤äº’è§„åˆ™

### âœ… å…è®¸çš„ä¾èµ–å…³ç³»

```
Router      â†’ Controller
Controller  â†’ Service
Controller  â†’ View
Controller  â†’ Model
Service     â†’ Model
View        â†’ Model
```

### âŒ ç¦æ­¢çš„ä¾èµ–å…³ç³»

```
Model       â†’ Service     (æ¨¡å‹ä¸åº”ä¾èµ–æœåŠ¡)
Model       â†’ Controller  (æ¨¡å‹ä¸åº”ä¾èµ–æ§åˆ¶å™¨)
Service     â†’ Controller  (æœåŠ¡ä¸åº”ä¾èµ–æ§åˆ¶å™¨)
Service     â†’ View        (æœåŠ¡ä¸åº”ä¾èµ–è§†å›¾)
View        â†’ Service     (è§†å›¾ä¸åº”ä¾èµ–æœåŠ¡)
View        â†’ Controller  (è§†å›¾ä¸åº”ä¾èµ–æ§åˆ¶å™¨)
```

## ğŸ“Š å®Œæ•´è¯·æ±‚ç¤ºä¾‹

### POST /api/echo è¯·æ±‚å¤„ç†æµç¨‹

```
1. Client å‘é€è¯·æ±‚
   POST /api/echo
   Content-Type: application/json
   Body: {"message": "Hello"}

2. Router æ¥æ”¶è¯·æ±‚
   â”œâ”€ è§£æ Method: POST
   â”œâ”€ è§£æ Path: /api/echo
   â””â”€ åŒ¹é…è·¯ç”± â†’ MessageController.handle_echo()

3. MessageController å¤„ç†
   â”œâ”€ è¯»å–è¯·æ±‚ä½“
   â”œâ”€ è§£æ JSON â†’ EchoRequest
   â”œâ”€ è°ƒç”¨ MessageService.handle_echo()
   â””â”€ ç­‰å¾… Service è¿”å›

4. MessageService å¤„ç†
   â”œâ”€ è°ƒç”¨ EchoRequest.validate()
   â”œâ”€ æ‰§è¡Œä¸šåŠ¡é€»è¾‘
   â””â”€ è¿”å› EchoResponse

5. MessageController ç»§ç»­
   â”œâ”€ æ„å»º ApiResponse
   â””â”€ è°ƒç”¨ JsonView.render()

6. JsonView æ¸²æŸ“
   â”œâ”€ åºåˆ—åŒ–ä¸º JSON
   â”œâ”€ è®¾ç½® HTTP å¤´
   â””â”€ è¿”å› Response

7. Router è¿”å›å“åº”
   â””â”€ å‘é€ç»™ Client

8. Client æ”¶åˆ°å“åº”
   HTTP/1.1 200 OK
   Content-Type: application/json
   
   {
     "success": true,
     "message": "Echo æˆåŠŸ",
     "data": {
       "echo": "Hello",
       "length": 5,
       "timestamp": "2026-01-12T10:30:00+08:00"
     }
   }
```

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### å„å±‚æµ‹è¯•é‡ç‚¹

| å±‚ | æµ‹è¯•é‡ç‚¹ | æµ‹è¯•æ–¹æ³• |
|----|---------|---------|
| Model | æ•°æ®éªŒè¯ã€åºåˆ—åŒ– | å•å…ƒæµ‹è¯• |
| Service | ä¸šåŠ¡é€»è¾‘ | å•å…ƒæµ‹è¯• |
| Controller | è¯·æ±‚å¤„ç†ã€é”™è¯¯å¤„ç† | å•å…ƒæµ‹è¯• |
| View | å“åº”æ ¼å¼ | å•å…ƒæµ‹è¯• |
| Router | è·¯ç”±åŒ¹é… | é›†æˆæµ‹è¯• |

## ğŸ“š æ€»ç»“

MVC æ¶æ„çš„æ ¸å¿ƒä¼˜åŠ¿ï¼š

1. **å…³æ³¨ç‚¹åˆ†ç¦»** - æ¯å±‚ä¸“æ³¨è‡ªå·±çš„èŒè´£
2. **å¯æµ‹è¯•æ€§** - å„å±‚å¯ç‹¬ç«‹æµ‹è¯•
3. **å¯ç»´æŠ¤æ€§** - ä¿®æ”¹æŸå±‚ä¸å½±å“å…¶ä»–å±‚
4. **å¯æ‰©å±•æ€§** - æ˜“äºæ·»åŠ æ–°åŠŸèƒ½
5. **ä»£ç å¤ç”¨** - Service å’Œ View å¯å¤ç”¨

è¿™ç§æ¶æ„ç‰¹åˆ«é€‚åˆæ„å»ºä¸­å¤§å‹ Web åº”ç”¨ï¼
